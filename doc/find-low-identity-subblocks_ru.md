# NPG-explorer

## Алгоритм нахождения блоков низкого уровня сходства

### Параметры

 * `min_length`
 * `min_identity`

Данные опции используются в алгоритме построения пангенома.
Значение `min_length` - минимальная длина качественного блока,
входящего в пангеном. Стандартное значение `min_length`
составляет 100 нуклеотидов. Значение `min_identity` - это
минимальная доля идентичных позиций в выравнивании блока
пангенома. Стандартное значение составляет 90%.

### Входы

Блок из пангенома.

### Выходы

Список блоков низкого уровня сходства. Блок низкого уровня
сходства - это блок, вырезанный из исходного блока. Он
соответствует отрезку из колонок выравнивания исходного блока.

### Алгоритм

Для каждой колонки блока определить, является ли она
качественной. Колонка считается качественной, если она
представлена одинаковой буквой в каждой последовательности
и эта буква одна из "A", "T", "G", "C".

После этого последовательные группы колонок с одинаковым
значением качества объединяются в группы. Каждой группе
присваивается изначальный вес. Изначальный вес качественной
группы равен её длине. Изначальный вес некачественной группы
вычисляется следующим образом:

```
вес = длина / (1 - min_identity).
```

Следующий шаг состоит в сокращении малых групп. Этот этап
основан на алгоритме [КЧП][kchp], который предложил Ш.Губерман
в [1].

 1. Если число групп равно 1, то алгоритм останавливается.
 2. Выбирается группа минимального веса.
    Если таких групп несколько, выбирается произвольная из них.
 3. Если вес выбранной группы больше или равен `min_length`,
    то алгоритм останавливается.
 4. Иначе эта группа объединяется с соседними группами.
    На их месте образуется группа, помеченная качеством
    соседних групп и весом, равным сумме весов объединяемых
    групп.
 5. Перейти к шагу 1.

Когда алгоритм останавливается, отбираются все некачественные
группы. Они объявляются блоками низкого уровня сходства.

### Ссылки

 1. Губерман Ш.А.
    Неформальный анализ данных в геологии и геофизике. -
    М.: Недра, 1987.

[kchp]: http://www.integro.ru/system/ots/guberman/guberman.htm
